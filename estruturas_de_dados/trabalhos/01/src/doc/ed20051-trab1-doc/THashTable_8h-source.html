<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Estrutura de Dados - Trabalho 1: THashTable.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Gerado por Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="main.html">Página&nbsp;Principal</a> | <a class="qindex" href="hierarchy.html">Hierarquia&nbsp;de&nbsp;Classes</a> | <a class="qindex" href="classes.html">Lista&nbsp;Alfabética</a> | <a class="qindex" href="annotated.html">Estruturas&nbsp;de&nbsp;Dados</a> | <a class="qindex" href="files.html">Lista&nbsp;de&nbsp;Arquivos</a> | <a class="qindex" href="functions.html">Campos&nbsp;de&nbsp;Dados</a></div>
<h1>THashTable.h</h1><pre class="fragment"><div>00001 <span class="comment">/*******************************************************</span>
00002 <span class="comment"> *              Estrutura de Dados                     *</span>
00003 <span class="comment"> *******************************************************</span>
00004 <span class="comment"> * Trabalho 1                                          *</span>
00005 <span class="comment"> * Professor: Fabrício V. Matos                        *</span>
00006 <span class="comment"> *******************************************************</span>
00007 <span class="comment"> * Aluno: Reinaldo de Souza Junior                     *</span>
00008 <span class="comment"> * Licensa: GPL vs2.0 [ veja /docs/LICENSE.txt ]       *</span>
00009 <span class="comment"> *******************************************************/</span>
00010 
00011 <span class="preprocessor">#ifndef THashTable_H</span>
00012 <span class="preprocessor"></span><span class="preprocessor">#define THashTable_H</span>
00013 <span class="preprocessor"></span>
00014 <span class="preprocessor">#include "TError.h"</span>
00015 <span class="preprocessor">#include "TList.h"</span>
00016 <span class="preprocessor">#include &lt;iostream&gt;</span>
00017 <span class="preprocessor">#include &lt;cmath&gt;</span>
00018 
<a name="l00026"></a><a class="code" href="classTHashTable.html">00026</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">class </span><a class="code" href="classTHashTable.html">THashTable</a> {
00027         <span class="keyword">public</span>:
00028         
<a name="l00036"></a><a class="code" href="classTHashTable.html#a0">00036</a>                 <a class="code" href="classTHashTable.html#a0">THashTable</a>() : <a class="code" href="classTHashTable.html#p3">fHash</a>(NULL) {};
00037 
00045                 <a class="code" href="classTHashTable.html#a0">THashTable</a>(<span class="keywordtype">int</span> tamanho, <span class="keywordtype">int</span>(*funcao)(T*, <span class="keywordtype">int</span>) = NULL);
00046 
00052                 <a class="code" href="classTHashTable.html#a2">~THashTable</a>();
00053 
00054                 <span class="comment">/**********************************************</span>
00055 <span class="comment">                 * Add()</span>
00056 <span class="comment">                 **********************************************</span>
00057 <span class="comment">                 * Insere um elemento</span>
00058 <span class="comment">                 **********************************************/</span>
00069                 <span class="keywordtype">int</span> Add(T* data);
00070 
00071                 <span class="comment">/**********************************************</span>
00072 <span class="comment">                 * Get()</span>
00073 <span class="comment">                 **********************************************</span>
00074 <span class="comment">                 * Localiza o elemento na tabela</span>
00075 <span class="comment">                 **********************************************/</span>
00085                 T* Get(T * data);
00086 
00087                 <span class="comment">/**********************************************</span>
00088 <span class="comment">                 * Count()</span>
00089 <span class="comment">                 **********************************************</span>
00090 <span class="comment">                 * Retorna o número de elementos da tabela hash</span>
00091 <span class="comment">                 **********************************************/</span>
<a name="l00098"></a><a class="code" href="classTHashTable.html#a5">00098</a>                 <span class="keywordtype">int</span> <a class="code" href="classTHashTable.html#a5">Count</a>() { <span class="keywordflow">return</span> Count; };
00099 
00100                 <span class="comment">/**********************************************</span>
00101 <span class="comment">                 * Size()</span>
00102 <span class="comment">                 **********************************************</span>
00103 <span class="comment">                 * Retorna o tamanho da tabela hash</span>
00104 <span class="comment">                 **********************************************/</span>
<a name="l00111"></a><a class="code" href="classTHashTable.html#a6">00111</a>                 <span class="keywordtype">int</span> <a class="code" href="classTHashTable.html#a6">Size</a>() { <span class="keywordflow">return</span> Size; };
00112 
00113                 <span class="comment">/**********************************************</span>
00114 <span class="comment">                 * Del()</span>
00115 <span class="comment">                 **********************************************</span>
00116 <span class="comment">                 * Remove um elemento da tabela hash</span>
00117 <span class="comment">                 **********************************************/</span>
00129                 <span class="keywordtype">bool</span> Del(T* data);
00130 
00131                 <span class="comment">/**********************************************</span>
00132 <span class="comment">                 * Kill()</span>
00133 <span class="comment">                 **********************************************</span>
00134 <span class="comment">                 * Remove e destrói um elemento da tabela hash</span>
00135 <span class="comment">                 **********************************************/</span>
00147                 <span class="keywordtype">bool</span> Kill(T* data);
00148 
00149                 <span class="comment">/**********************************************</span>
00150 <span class="comment">                 * DelAll()</span>
00151 <span class="comment">                 **********************************************</span>
00152 <span class="comment">                 * Remove todos os elemento da tabela hash</span>
00153 <span class="comment">                 **********************************************/</span>
00159                 <span class="keywordtype">void</span> <a class="code" href="classTHashTable.html#a9">DelAll</a>();
00160 
00161                 <span class="comment">/**********************************************</span>
00162 <span class="comment">                 * KillAll()</span>
00163 <span class="comment">                 **********************************************</span>
00164 <span class="comment">                 * Remove e destrói todos os elemento da tabela hash</span>
00165 <span class="comment">                 **********************************************/</span>
00171                 <span class="keywordtype">void</span> <a class="code" href="classTHashTable.html#a10">KillAll</a>();
00172 
00173 <span class="preprocessor">#ifdef DEBUG</span>
00174 <span class="preprocessor"></span>                <span class="comment">/**********************************************</span>
00175 <span class="comment">                 * Dump()</span>
00176 <span class="comment">                 **********************************************</span>
00177 <span class="comment">                 * Exibe os dados do objeto</span>
00178 <span class="comment">                 **********************************************/</span>
00186                 <span class="keywordtype">void</span> Dump();
00187 <span class="preprocessor">#endif</span>
00188 <span class="preprocessor"></span>                
00189         <span class="keyword">protected</span>:
<a name="l00190"></a><a class="code" href="classTHashTable.html#p0">00190</a>                 <span class="keywordtype">int</span> <a class="code" href="classTHashTable.html#p0">iSize</a>;              
<a name="l00191"></a><a class="code" href="classTHashTable.html#p1">00191</a>                 <span class="keywordtype">int</span> <a class="code" href="classTHashTable.html#p1">iCount</a>;             
<a name="l00192"></a><a class="code" href="classTHashTable.html#p2">00192</a>                 <a class="code" href="classTList.html">TList&lt;T&gt;</a>* <a class="code" href="classTHashTable.html#p2">Table</a>;        
00193                 int(*fHash)(T*, <span class="keywordtype">int</span>);   
00195         <span class="keyword">private</span>:
00196                 <span class="comment">/**********************************************</span>
00197 <span class="comment">                 * Hash()</span>
00198 <span class="comment">                 **********************************************</span>
00199 <span class="comment">                 * Algoritmo padrão de cálculo do Hash</span>
00200 <span class="comment">                 **********************************************/</span>
00209                 <span class="keywordtype">int</span> <a class="code" href="classTHashTable.html#d0">Hash</a>(T* data, <span class="keywordtype">int</span> tamanho);
00210 };
00211 
00212 
00213 
<a name="l00214"></a><a class="code" href="classTHashTable.html#a2">00214</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <a class="code" href="classTHashTable.html#a2">THashTable&lt;T&gt;::~THashTable</a>()
00215 {
00216         <span class="comment">//Limpa a memoria</span>
00217         <span class="comment">//Isso deleta todos os elementos e chama o destrutor padrão de todos automaticamente</span>
00218         <span class="keyword">delete</span>[] <a class="code" href="classTHashTable.html#p2">Table</a>;
00219 }
00220 
00221 
<a name="l00222"></a><a class="code" href="classTHashTable.html#a1">00222</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <a class="code" href="classTHashTable.html#a0">THashTable&lt;T&gt;::THashTable</a>(<span class="keywordtype">int</span> tamanho, <span class="keywordtype">int</span>(*funcao)(T*, <span class="keywordtype">int</span>)) : iSize(tamanho), fHash(funcao)
00223 {
00224         <span class="comment">//Aloca espaço para a tabela</span>
00225         <span class="comment">//Não precisa iniciar cada Lista, pois o construtor padrão é chamado automaticamente.</span>
00226         <a class="code" href="classTHashTable.html#p2">Table</a> = <span class="keyword">new</span> <a class="code" href="classTList.html">TList&lt;T&gt;</a>[<a class="code" href="classTHashTable.html#p0">iSize</a>];
00227 
00228         <span class="comment">/*</span>
00229 <span class="comment">         * Preferi não gerar a exceção e caso a funcao não seja informada,</span>
00230 <span class="comment">         * utilizar a função sugerida pelo professor</span>
00231 <span class="comment">         */</span>
00232 }
00233 
00234 
<a name="l00235"></a><a class="code" href="classTHashTable.html#d0">00235</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">int</span> <a class="code" href="classTHashTable.html">THashTable&lt;T&gt;::Hash</a>(T* data, <span class="keywordtype">int</span> tamanho)
00236 {
00237         <span class="comment">//Constante mágica sugerida pelo Sr. Donald E. Knuth</span>
00238         <span class="keywordtype">float</span> k = (sqrt(5) - 1) / 2;
00239         
00240         <span class="keywordflow">return</span> (<span class="keywordtype">int</span>) floor( tamanho * ( (<span class="keywordtype">int</span>) (*data) * k - floor( (<span class="keywordtype">int</span>) (*data) * k ) ) );
00241 }
00242 
00243 
<a name="l00244"></a><a class="code" href="classTHashTable.html#a3">00244</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">int</span> <a class="code" href="classTHashTable.html">THashTable&lt;T&gt;::Add</a>(T* data)
00245 {
00246         <span class="comment">//Elemento nulo</span>
00247         <span class="keywordflow">if</span>(data == NULL)
00248                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classTENullElement.html">TENullElement</a>(<span class="stringliteral">"THashTable::Add"</span>);
00249 
00250         <span class="comment">/*</span>
00251 <span class="comment">         * Chave do item</span>
00252 <span class="comment">         * Utiliza por padrão a função fornecida pela classe</span>
00253 <span class="comment">         */</span>
00254         <span class="keywordtype">int</span> chave = (NULL != <a class="code" href="classTHashTable.html#p3">fHash</a>) ? <a class="code" href="classTHashTable.html#p3">fHash</a>(data, <a class="code" href="classTHashTable.html#p0">iSize</a>) : <a class="code" href="classTHashTable.html#d0">Hash</a>(data, <a class="code" href="classTHashTable.html#p0">iSize</a>);
00255 
00256 <span class="preprocessor">#ifdef DEBUG</span>
00257 <span class="preprocessor"></span>std::cerr &lt;&lt; <span class="stringliteral">"[chave] "</span> &lt;&lt; chave &lt;&lt; std::endl;
00258 <span class="preprocessor">#endif</span>
00259 <span class="preprocessor"></span>        
00260         <span class="comment">//Função inválida</span>
00261         <span class="keywordflow">if</span>( chave &lt; 0 || chave &gt;= <a class="code" href="classTHashTable.html#p0">iSize</a> )
00262                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classTEInvalidHashFunction.html">TEInvalidHashFunction</a>(<span class="stringliteral">"THashTable::Add"</span>);
00263 
00264         <span class="comment">//Insere o elemento</span>
00265         <a class="code" href="classTHashTable.html#p2">Table</a>[chave].Insert(data, 0);
00266         
00267         <span class="comment">//Contador</span>
00268         <a class="code" href="classTHashTable.html#p1">iCount</a>++;
00269 
00270         <span class="comment">//Retorna a posicao da tabela onde o elemento foi inserido</span>
00271         <span class="keywordflow">return</span> chave;
00272 }
00273 
00274 
<a name="l00275"></a><a class="code" href="classTHashTable.html#a4">00275</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; T* <a class="code" href="classTHashTable.html">THashTable&lt;T&gt;::Get</a>(T* data)
00276 {
00277         <span class="comment">//Elemento nulo</span>
00278         <span class="keywordflow">if</span>(data == NULL)
00279                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classTENullElement.html">TENullElement</a>(<span class="stringliteral">"THashTable::Get"</span>);
00280 
00281         <span class="comment">/*</span>
00282 <span class="comment">         * Chave do item</span>
00283 <span class="comment">         * Utiliza por padrão a função fornecida pela classe</span>
00284 <span class="comment">         */</span>
00285         <span class="keywordtype">int</span> chave = (NULL != <a class="code" href="classTHashTable.html#p3">fHash</a>) ? <a class="code" href="classTHashTable.html#p3">fHash</a>(data, <a class="code" href="classTHashTable.html#p0">iSize</a>) : <a class="code" href="classTHashTable.html#d0">Hash</a>(data, <a class="code" href="classTHashTable.html#p0">iSize</a>);
00286 
00287         <span class="comment">//Posicao do elemento na lista</span>
00288 <span class="comment">//      int posicao = Table[chave].Search(data);</span>
00289 
00290         <span class="comment">//Aproveita-se da exceção que será gerada ao passar uma posição inválida para o método Get()</span>
00291         <span class="comment">//caso o elemento não seja encontrado</span>
00292         <span class="keywordflow">try</span> {
00293                 <span class="keywordflow">return</span> <a class="code" href="classTHashTable.html#p2">Table</a>[chave].Get( <a class="code" href="classTHashTable.html#p2">Table</a>[chave].Search(data) );
00294         }
00295         <span class="keywordflow">catch</span>(<a class="code" href="classTEOutOfBounds.html">TEOutOfBounds</a>*)
00296         {
00297                 <span class="keywordflow">return</span> NULL;
00298         }
00299 }
00300 
<a name="l00301"></a><a class="code" href="classTHashTable.html#a7">00301</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">bool</span> <a class="code" href="classTHashTable.html">THashTable&lt;T&gt;::Del</a>(T* data)
00302 {
00303         <span class="comment">//Elemento nulo</span>
00304         <span class="keywordflow">if</span>(data == NULL)
00305                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classTENullElement.html">TENullElement</a>(<span class="stringliteral">"THashTable::Del"</span>);
00306 
00307         <span class="comment">/*</span>
00308 <span class="comment">         * Chave do item</span>
00309 <span class="comment">         * Utiliza por padrão a função fornecida pela classe</span>
00310 <span class="comment">         */</span>
00311         <span class="keywordtype">int</span> chave = (NULL != <a class="code" href="classTHashTable.html#p3">fHash</a>) ? <a class="code" href="classTHashTable.html#p3">fHash</a>(data, <a class="code" href="classTHashTable.html#p0">iSize</a>) : <a class="code" href="classTHashTable.html#d0">Hash</a>(data, <a class="code" href="classTHashTable.html#p0">iSize</a>);
00312 
00313         <span class="comment">//Aproveita-se da exceção que será gerada ao passar uma posição inválida para o método Get()</span>
00314         <span class="comment">//caso o elemento não seja encontrado</span>
00315         <span class="keywordflow">try</span> {
00316                 <a class="code" href="classTHashTable.html#p2">Table</a>[chave].Del( <a class="code" href="classTHashTable.html#p2">Table</a>[chave].Search(data) );
00317                 <a class="code" href="classTHashTable.html#p1">iCount</a>--;
00318                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
00319         }
00320         <span class="keywordflow">catch</span>(<a class="code" href="classTEOutOfBounds.html">TEOutOfBounds</a>*)
00321         {
00322                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00323         }
00324 }
00325 
00326 
<a name="l00327"></a><a class="code" href="classTHashTable.html#a8">00327</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">bool</span> <a class="code" href="classTHashTable.html">THashTable&lt;T&gt;::Kill</a>(T* data)
00328 {
00329         <span class="comment">//Elemento nulo</span>
00330         <span class="keywordflow">if</span>(data == NULL)
00331                 <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classTENullElement.html">TENullElement</a>(<span class="stringliteral">"THashTable::Kill"</span>);
00332 
00333         <span class="comment">/*</span>
00334 <span class="comment">         * Chave do item</span>
00335 <span class="comment">         * Utiliza por padrão a função fornecida pela classe</span>
00336 <span class="comment">         */</span>
00337         <span class="keywordtype">int</span> chave = (NULL != <a class="code" href="classTHashTable.html#p3">fHash</a>) ? <a class="code" href="classTHashTable.html#p3">fHash</a>(data, <a class="code" href="classTHashTable.html#p0">iSize</a>) : <a class="code" href="classTHashTable.html#d0">Hash</a>(data, <a class="code" href="classTHashTable.html#p0">iSize</a>);
00338 
00339         <span class="comment">//Aproveita-se da exceção que será gerada ao passar uma posição inválida para o método Get()</span>
00340         <span class="comment">//caso o elemento não seja encontrado</span>
00341         <span class="keywordflow">try</span> {
00342                 <a class="code" href="classTHashTable.html#p2">Table</a>[chave].Kill( <a class="code" href="classTHashTable.html#p2">Table</a>[chave].Search(data) ); <span class="comment">//O(1)</span>
00343                 <a class="code" href="classTHashTable.html#p1">iCount</a>--;
00344                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
00345         }
00346         <span class="keywordflow">catch</span>(<a class="code" href="classTEOutOfBounds.html">TEOutOfBounds</a>*)
00347         {
00348                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
00349         }
00350 }
00351 
00352 
<a name="l00353"></a><a class="code" href="classTHashTable.html#a9">00353</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classTHashTable.html#a9">THashTable&lt;T&gt;::DelAll</a>()
00354 {
00355         <span class="comment">//Varre a tabela</span>
00356         <span class="keywordtype">int</span> i;
00357         <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="classTHashTable.html#p0">iSize</a>; i++)      <span class="comment">//O(n)</span>
00358         {
00359                 <a class="code" href="classTHashTable.html#p2">Table</a>[i].DelAll();      <span class="comment">//O(1)</span>
00360         }
00361 }
00362 
00363 
<a name="l00364"></a><a class="code" href="classTHashTable.html#a10">00364</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classTHashTable.html#a10">THashTable&lt;T&gt;::KillAll</a>()
00365 {
00366         <span class="comment">//Varre a tabela</span>
00367         <span class="keywordtype">int</span> i;
00368         <span class="keywordflow">for</span>(i = 0; i &lt; <a class="code" href="classTHashTable.html#p0">iSize</a>; i++)      <span class="comment">//O(n)</span>
00369         {
00370                 <a class="code" href="classTHashTable.html#p2">Table</a>[i].KillAll();     <span class="comment">//O(1)</span>
00371         }
00372 }
00373 
00374 <span class="preprocessor">#ifdef DEBUG</span>
00375 <span class="preprocessor"></span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classTHashTable.html">THashTable&lt;T&gt;::Dump</a>()
00376 {
00377         std::cerr &lt;&lt; endl
00378                         &lt;&lt; <span class="stringliteral">"+-----------[THashTable]-----------+"</span> &lt;&lt; std::endl
00379                         &lt;&lt; <span class="stringliteral">"| iSize \t = "</span> &lt;&lt;   iSize   &lt;&lt; std::endl    
00380                         &lt;&lt; <span class="stringliteral">"| iCount \t = "</span> &lt;&lt;  iCount  &lt;&lt; std::endl
00381                         &lt;&lt; <span class="stringliteral">"| Table \t = "</span> &lt;&lt;   Table   &lt;&lt; std::endl
00382                         &lt;&lt; <span class="stringliteral">"| fHash \t = "</span> &lt;&lt;   fHash   &lt;&lt; std::endl
00383                         &lt;&lt; <span class="stringliteral">"+----------------------------------+"</span> &lt;&lt; std::endl &lt;&lt; std::endl;
00384 
00385         <span class="keywordtype">int</span> i;
00386         <span class="keywordflow">for</span>(i = 0; i &lt; iSize; i++)
00387         {
00388                 std::cerr &lt;&lt; <span class="stringliteral">"        {###} Table["</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">"] {###} "</span>;
00389                 Table[i].Dump();
00390         }
00391 }
00392 <span class="preprocessor">#endif</span>
00393 <span class="preprocessor"></span>
00394 <span class="preprocessor">#endif</span>
</div></pre><hr size="1"><address style="align: right;"><small>Gerado em Tue Jun 7 22:36:05 2005 para Estrutura de Dados - Trabalho 1 por
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
